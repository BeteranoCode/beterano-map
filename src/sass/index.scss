@use "sass:math";

/* ‚úÖ IMPORTACI√ìN MODERNA */
@use "./_mixins.scss" as *;
@use "./_variables.scss" as *;

/* Nuestros componentes que deben ganar */
@use "./components/_sidebar.scss" as *;
@use "./components/_map.scss" as *;
@use "./components/_toggle.scss" as *;
@use "./components/_panel.scss" as *;   /* estilos del modal */
@use "./components/_components.scss" as *;

/* RESET */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: sans-serif;
  overflow-x: hidden;
}

/* üîù Contenedor del header inyectado: no debe reservar espacio */
#header-container {
  width: 100%;
  position: fixed;
  top: 0; left: 0;
  z-index: 9999;
  height: auto !important;
  max-height: none !important;
  pointer-events: none; /* el header dentro sigue siendo clickable */
}
#header-container * { pointer-events: auto; }

/* üëá NO usar offsets aqu√≠: el header controla la altura √∫til */
#root {
  position: relative;
  min-height: auto;
  height: auto;
  overflow: hidden;            /* el scroll vive dentro de sidebar/cards */
  display: flex;
  flex-direction: column;
}

/* ====== LAYOUT PRINCIPAL ====== */
.layout-container {
  flex: 1 1 auto;              /* ocupa el resto de altura bajo el header */
  min-height: 0;               /* permite que los hijos usen 100% sin desbordar */
  display: flex;
  width: 100%;
  gap: 0;

  /* m√≥vil por defecto: columna (lista arriba, mapa abajo) */
  flex-direction: column;

  /* a partir de 600px: fila para que el mapa use el hueco derecho */
  @media (min-width: 600px) {
    flex-direction: row;
  }
}

/* ====== SIDEBAR ====== */
/* Base: escalable. Da aire y evita quedarse "apretado" respecto al dock */
.sidebar {
  /* ancho entre 320 y 420, aprox 38vw como punto medio */
  flex: 0 0 clamp(320px, 38vw, 420px);
  min-width: 300px;
  max-width: 480px;
  height: 100%;
  overflow: auto;
  position: relative; /* para sticky children */

  /* m√≥vil puro (<600): ocupa 100% arriba */
  @media (max-width: 599px) {
    flex: 0 0 auto;
    width: 100%;
    max-width: none;
  }

  /* escritorio ancho (‚â•900): m√°s espacio para filtros + dock */
  @media (min-width: 900px) {
    flex: 0 0 clamp(380px, 32vw, 540px);
    max-width: 540px;
  }
}

/* ====== MAPA ====== */
.map-container {
  flex: 1 1 auto;
  min-width: 0;
  height: 100%;
  position: relative;
  z-index: 1;
}
.map-leaflet-wrapper { position: absolute; inset: 0; width: 100%; height: 100%; }
.leaflet-container    { position: absolute; inset: 0; width: 100% !important; height: 100% !important; }

/* ====== DOCKS ====== */
/* Por defecto ocultamos el inline-dock (solo escritorio) */
.inline-dock { display: none; }

/* Escritorio compacto: 768‚Äì899px
   - ocultar mobile dock
   - mostrar inline dock sticky en la cabecera del sidebar
*/
@media (min-width: 768px) and (max-width: 899px) {
  .inline-dock {
    display: block;
    position: sticky;
    top: 0;
    z-index: 2;
    background: #f9e6a8;       /* amarillo pastel del sidebar */
    padding: 10px 12px 6px;
    border-bottom: 1px solid rgba(0,0,0,.06);
  }
  /* reserva un pel√≠n de espacio para no tapar filtros */
  .sidebar .sidebar__content { padding-top: 8px; }
}

/* Escritorio ‚â•900px (sidebar m√°s ancho) */
@media (min-width: 900px) {
  .inline-dock {
    display: block;
    position: sticky;
    top: 0;
    z-index: 2;
    background: #f9e6a8;
    padding: 12px 12px 8px;
    border-bottom: 1px solid rgba(0,0,0,.06);
  }
  .sidebar .sidebar__content { padding-top: 8px; }
  .sidebar .tribes-filter { margin-top: 8px; }
}

/* si tu inline-dock contiene la clase .dock, dale layout horizontal bonito */
.inline-dock .dock {
  display: grid;
  grid-auto-flow: column;
  gap: 8px;
  justify-content: start;
}
.inline-dock .dock-btn { background: #fff; }

/* ====== Modo local (sin header real) ====== */
body.local-dev #header-container { background: #f8f8f8; border-bottom: 1px solid #ddd; }
body.local-dev { --header-offset: 125px; }

/* Centrar navegaci√≥n en escritorio (header externo) */
@media (min-width: 1024px) {
  #site-header { display: flex; align-items: center; }
  #site-header .nav-wrapper {
    margin: 0 auto;
    display: flex;
    justify-content: center;
  }
}
